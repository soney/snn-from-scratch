
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Translating Data to Spikes &#8212; Building Spiking Neural Networks (SNNs) from Scratch</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=474c4726" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/10 - Translating Data to Spikes';</script>
    <script src="../_static/javascript-components.js?v=a8af3629"></script>
    <script src="../_static/pyodide/webworker.js?v=10c66e99"></script>
    <script src="../_static/pyodide/pyodide.asm.js?v=77e5d317"></script>
    <script src="../_static/pyodide/pyodide.js?v=be10f41f"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Representing 2D Images" href="11%20-%20Representing%202D%20Images.html" />
    <link rel="prev" title="Collections of Neurons" href="09%20-%20Collections%20of%20Neurons.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="01%20-%20Root.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nmc-logo.png" class="logo__image only-light" alt="Building Spiking Neural Networks (SNNs) from Scratch - Home"/>
    <script>document.write(`<img src="../_static/nmc-logo.png" class="logo__image only-dark" alt="Building Spiking Neural Networks (SNNs) from Scratch - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="01%20-%20Root.html">
                    Building Spiking Neural Networks (SNNs) from Scratch
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="02%20-%20Textbook.html">Using this Textbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modeling LIF Neurons</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03%20-%20Basic%20Neuron%20Models.html">Basic Neuron Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="04%20-%20First%20Order%20LI.html">First-Order Approximations of LI Neurons</a></li>
<li class="toctree-l1"><a class="reference internal" href="05%20-%20Implementing%20Firing.html">Implementing Firing in LIF Neurons</a></li>
<li class="toctree-l1"><a class="reference internal" href="06%20-%20Firing%20Rates%20and%20Tuning%20Curves.html">Firing Rates and Tuning Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="07%20-%20Synapses.html">Synapses</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Encoding Information</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="08%20-%20Encoding%20and%20Decoding%20Information.html">Encoding and Decoding Information</a></li>

<li class="toctree-l1"><a class="reference internal" href="09%20-%20Collections%20of%20Neurons.html">Collections of Neurons</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Translating Data to Spikes</a></li>
<li class="toctree-l1"><a class="reference internal" href="11%20-%20Representing%202D%20Images.html">Representing 2D Images</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Scaling Up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="12%20-%20Improving%20Accuracy.html">Improving Accuracy</a></li>
<li class="toctree-l1"><a class="reference internal" href="13%20-%20Neuron%20Collections.html">Neuron Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="14%20-%20Weights%20and%20Connections.html">Weights and Connections</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Learning and Adaptation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="15%20-%20Adaptive%20LIF%20Neurons.html">Adaptive LIF Neurons</a></li>
<li class="toctree-l1"><a class="reference internal" href="16%20-%20STDP.html">Learning through Spike-Timing Dependent Plasticity (STDP)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Research Replication</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="17%20-%20Research%20Replication%201.html">Research Replication: Unsupervised Learning of Digit Recognition Using STDP (Part 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="18%20-%20Research%20Replication%202.html">Research Replication: Unsupervised Learning of Digit Recognition Using STDP (Part 2)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/soney/snn-from-scratch" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/soney/snn-from-scratch/issues/new?title=Issue%20on%20page%20%2Fchapters/10 - Translating Data to Spikes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/10 - Translating Data to Spikes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Translating Data to Spikes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-firing">Probabilistic Firing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats">Caveats:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="translating-data-to-spikes">
<h1>Translating Data to Spikes<a class="headerlink" href="#translating-data-to-spikes" title="Link to this heading">#</a></h1>
<p>Suppose we have some data—whether an image, audio content, or some other form of information—and we want to represent it as spikes. In other words, we have some <strong>external</strong> data source and we want to “input” it into our neuromorphic system. How can we do this?</p>
<p>Let’s start with something like a scalar number. How would we translate this into spikes? We could use either <strong>frequency</strong> encoding (where we send information by communicating with <em>how often</em> our neuron fires) or <strong>time</strong> encoding (where we send information through the precise <em>timing</em> of neuron fires). <strong>Let’s focus on frequency coding</strong>.</p>
<p>A simple way would be to spike in proportion to the value of the number; the higher the number, the more spikes. So let’s suppose we have a target number <span class="math notranslate nohighlight">\(v\)</span> that we want to represent in spikes. If <span class="math notranslate nohighlight">\(v\)</span> is positive, we can do this easily by translating <span class="math notranslate nohighlight">\(v\)</span> into a <strong>firing rate</strong> (number of spikes per second). This would mean that we fire <span class="math notranslate nohighlight">\(v\)</span> times per second…or once every <span class="math notranslate nohighlight">\(\frac{1}{v}\)</span> seconds, if <span class="math notranslate nohighlight">\(v\)</span> is positive.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># Show a plot of the spikes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">height</span><span class="o">/</span><span class="mi">100</span><span class="p">))</span> <span class="c1"># Create a new figure</span>
    <span class="n">spacing</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">padding</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span> <span class="c1"># The factor to multiply spike time by to get an x position</span>
    
    <span class="n">spike_width</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">spike_height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">padding</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">padding</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">spikes</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="n">spacing</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">spike_width</span><span class="p">,</span> <span class="n">spike_height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off the axis</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">simple_frequency_spikes</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span> <span class="c1"># Generate a list of spiking times</span>
    <span class="n">spikes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># Since we divide by freq, we can&#39;t have freq = 0</span>
        <span class="n">period</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">freq</span> <span class="c1"># The time between spikes</span>
        <span class="n">steps_per_spike</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">period</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span> <span class="c1"># The number of steps between spikes</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">steps_per_spike</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
                <span class="n">spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">spikes</span><span class="p">,</span> <span class="n">T</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">simple_frequency_spikes</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spikes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="si">}</span><span class="s2"> over </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> seconds (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">T</span><span class="si">}</span><span class="s2"> Hz)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/28d3fcef238370eb355040c9caa8a7312fd2394c444f92661fff1c47f7c41747.png" src="../_images/28d3fcef238370eb355040c9caa8a7312fd2394c444f92661fff1c47f7c41747.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spikes: 100 over 100 seconds (1.0 Hz)
</pre></div>
</div>
</div>
</div>
<div class="custom---spikes-by-frequency"
                                          data-arguments = "[]"
                                          data-options   = "{}"
                                          data-content   = "&quot;&quot;"
                                          id             = "spikes-by-frequency-1-hash-8746514286489854841"
                                          ></div><p>This works but has a few problems. First, it does not account for things like negative numbers (you can’t have a negative frequency). So let’s say that we assume that <span class="math notranslate nohighlight">\(v\)</span> is in the range <span class="math notranslate nohighlight">\([v_{min}, v_{max}]\)</span>. We can then scale our prior value of <span class="math notranslate nohighlight">\(v\)</span> to be <span class="math notranslate nohighlight">\(v_s\)</span> and ensure it is in the range <span class="math notranslate nohighlight">\([0, 1]\)</span>: <span class="math notranslate nohighlight">\(v_s = \frac{v-v_{min}}{v_{max}-v_{min}}\)</span>.</p>
<p>Then, if we want it to use frequencies outside of <span class="math notranslate nohighlight">\([0, 1]\)</span> (say we want frequencies in the range <span class="math notranslate nohighlight">\([f_{min}, f_{max}]\)</span>), we can do: <span class="math notranslate nohighlight">\(f_s(v) = f_{min} + v_s(f_{max}-f_{min}) = f_{min} + \frac{v-v_{min}}{v_{max}-v_{min}}(f_{max}-f_{min})\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scaled_frequency_spikes</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">v_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">simple_frequency_spikes</span><span class="p">(</span><span class="n">f_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">v_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">v_max</span> <span class="o">-</span> <span class="n">v_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_max</span> <span class="o">-</span> <span class="n">f_min</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">spikes</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">scaled_frequency_spikes</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">v_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v_max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spikes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="si">}</span><span class="s2"> over </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> seconds (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">T</span><span class="si">}</span><span class="s2"> Hz)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/c95dfd074d1f98f58518aead32584fc16d075477bc5225e7d7c0b70abbdf8197.png" src="../_images/c95dfd074d1f98f58518aead32584fc16d075477bc5225e7d7c0b70abbdf8197.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spikes: 182 over 100 seconds (1.82 Hz)
</pre></div>
</div>
</div>
</div>
<div class="custom---scaled-spikes-by-frequency"
                                          data-arguments = "[]"
                                          data-options   = "{}"
                                          data-content   = "&quot;&quot;"
                                          id             = "scaled-spikes-by-frequency-1-hash-8746514286489854841"
                                          ></div><p>This works but it has a few drawbacks. First, if we want regular spiking intervals then we need to have some notion of state in order to track if we should fire at a given timestep or not. Second, it does not contain any noise. Noise can help improve the robustness of our systems (and make them more realistic) by (1) ensuring that the system is recognizing common underlying patterns rather than overfitting to specific examples and (2) making sure it is more tolerant to errors and noisier inputs.</p>
<p>Instead, it is common to use Poisson processes to represent these data probabilistically.</p>
<section id="probabilistic-firing">
<h2>Probabilistic Firing<a class="headerlink" href="#probabilistic-firing" title="Link to this heading">#</a></h2>
<p>We want to have a <strong>probability</strong> of firing that will likely result in firing rate <span class="math notranslate nohighlight">\(f_s(v)\)</span>. Like before, suppose we want to represent scalar <span class="math notranslate nohighlight">\(v\)</span> with firing rate <span class="math notranslate nohighlight">\(f_s(v) = f_{min} + \frac{v-v_{min}}{v_{max}-v_{min}}(f_{max}-f_{min})\)</span>. To do this, we want to have a probability of <span class="math notranslate nohighlight">\(f_s(v)\)</span> of firing every second. This means that in a discrete simulation with timesteps <span class="math notranslate nohighlight">\(T_{step}\)</span>, we should have a probability of firing as <span class="math notranslate nohighlight">\(f_s(v) T_{step}\)</span> on every timestep:</p>
<div class="math notranslate nohighlight">
\[Pr(fire) = T_{step}(f_{min} + \frac{v-v_{min}}{v_{max}-v_{min}}(f_{max}-f_{min}))\]</div>
<p>…then given a number of spikes <span class="math notranslate nohighlight">\(s\)</span> over time <span class="math notranslate nohighlight">\(T_{step}\)</span>, our frequency is <span class="math notranslate nohighlight">\(\frac{s}{T_{step}}\)</span> and we can estimate our value by solving for <span class="math notranslate nohighlight">\(\hat{x}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\hat{v} = \frac{\frac{s}{T_{step}}-f_{min}}{f_{max}-f_{min}}(v_{max} - v_{min}) + v_{min}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">poisson_spikes</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="n">spikes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">probFire</span> <span class="o">=</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">numSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numSteps</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">probFire</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
            <span class="n">spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spikes</span><span class="p">,</span> <span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scaled_poission_spikes</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">poisson_spikes</span><span class="p">(</span><span class="n">f_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">val_max</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_max</span> <span class="o">-</span> <span class="n">f_min</span><span class="p">),</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">val</span>   <span class="o">=</span> <span class="mi">10</span>
<span class="n">v_min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">v_max</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">f_min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">spikes</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">scaled_poission_spikes</span><span class="p">(</span><span class="n">val</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">v_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">v_max</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="n">f_min</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="n">f_max</span><span class="p">)</span>
<span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">estimated_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_max</span> <span class="o">-</span> <span class="n">v_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">f_max</span> <span class="o">-</span> <span class="n">f_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">v_min</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spikes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="si">}</span><span class="s2"> over </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2"> seconds (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">T</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz). Estimated Value: </span><span class="si">{</span><span class="n">estimated_value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (Actual: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">; Error: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">estimated_value</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/d11db90c0fa02a8a8be706205dcfdf17ea3d6bd019ec8f2f6f1687380f950f3e.png" src="../_images/d11db90c0fa02a8a8be706205dcfdf17ea3d6bd019ec8f2f6f1687380f950f3e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Spikes: 117 over 100 seconds (1.17 Hz). Estimated Value: 11.70 (Actual: 10; Error: 1.70)
</pre></div>
</div>
</div>
</div>
<div class="custom---poisson-spikes"
                                          data-arguments = "[]"
                                          data-options   = "{}"
                                          data-content   = "&quot;&quot;"
                                          id             = "poisson-spikes-1-hash-8746514286489854841"
                                          ></div><p>Let’s look at how the estimated value varies compared to the actual value when we do this. For now, we’ll use the values <code class="docutils literal notranslate"><span class="pre">f_min</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">f_max</span> <span class="pre">=</span> <span class="pre">100</span></code>, <code class="docutils literal notranslate"><span class="pre">x_min</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">x_max</span> <span class="pre">=</span> <span class="pre">100</span></code>. We’ll use a discrete time simulation with <code class="docutils literal notranslate"><span class="pre">Tstep</span> <span class="pre">=</span> <span class="pre">0.01</span></code> for every step:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">plot_values</span><span class="p">(</span><span class="n">val_min</span><span class="p">,</span> <span class="n">val_max</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">val_step</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">estimated_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">actual_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">val_min</span><span class="p">,</span> <span class="n">val_max</span><span class="p">,</span> <span class="n">val_step</span><span class="p">):</span>
        <span class="n">spikes</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">scaled_poission_spikes</span><span class="p">(</span><span class="n">val</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">val_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">val_max</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="n">f_min</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="n">f_max</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
        <span class="n">estimated_value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_max</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">f_max</span> <span class="o">-</span> <span class="n">f_min</span><span class="p">)</span> <span class="o">+</span> <span class="n">val_min</span>
        <span class="n">estimated_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimated_value</span><span class="p">)</span>
        <span class="n">actual_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">estimated_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">actual_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Actual Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Estimated Value&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1583e18782aaf26e6f7cec3ecca0ee8f7e097b5faa7b0c7c2d735e48de80325c.png" src="../_images/1583e18782aaf26e6f7cec3ecca0ee8f7e097b5faa7b0c7c2d735e48de80325c.png" />
</div>
</div>
<p>We can see that our reconstructed estimates look fairly reasonable. Now let’s look at what happens if we increase <code class="docutils literal notranslate"><span class="pre">f_max</span></code> to <code class="docutils literal notranslate"><span class="pre">200</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6571681cc486dfedc2bbb95af07cbdb8d521304f4169e6067c651ed257f25de6.png" src="../_images/6571681cc486dfedc2bbb95af07cbdb8d521304f4169e6067c651ed257f25de6.png" />
</div>
</div>
<p>Notice how our estimate stops increasing around <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">2.5</span></code>? This corresponds to a frequency of 100 Hz. Given that we had a value of <code class="docutils literal notranslate"><span class="pre">Tstep</span> <span class="pre">=</span> <span class="pre">0.01</span></code>, we can never achieve a frequency greater than <span class="math notranslate nohighlight">\(\frac{1}{T_{step}} = 100\)</span> since we can only fire a maximum of one time per time step in our discrete time simulation.</p>
<p>This tells us that we need to be sure our maximum frequency is not so high that we would need multiple firings per time step for our discrete time simulation; <span class="math notranslate nohighlight">\(f_{max} \leq \frac{1}{T_{step}}\)</span>.</p>
<p>Note that Poisson processes can “handle” this by assuming that there might be multiple events in every step and they estimate the probability of <span class="math notranslate nohighlight">\(k\)</span> firings as <span class="math notranslate nohighlight">\(\frac{\lambda{}^k}{k!}e^{-\lambda{}}\)</span> where <span class="math notranslate nohighlight">\(\lambda{} = Pr(fire)\)</span> from above.</p>
<p>However, rather than allowing multiple spikes per timestep, we will just choose time-steps small enough that we can assume it’s exceedingly unlikely that multiple spikes will fire per timestep.</p>
<section id="caveats">
<h3>Caveats:<a class="headerlink" href="#caveats" title="Link to this heading">#</a></h3>
<p>Poisson processes make the assumption that the likelyhood of firing at every timestep is completely independent. This isn’t quite biologically realistic, because:</p>
<ul class="simple">
<li><p>Neurons have a refractory period; they are less likely to fire immediately after they have just fired</p></li>
<li><p>Some neurons (like “burst” neurons) have special properties that make them more likely to fire in bursts.</p></li>
</ul>
<p>However, we aren’t concerned about biological realism here and so will ignore these caveats. <a class="reference external" href="https://www.cns.nyu.edu/~david/handouts/poisson.pdf">Prior work has attempted to address them</a>.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We often model data sources as Poisson processes</p></li>
<li><p>These models can represent values as probabilistic frequencies</p></li>
<li><p>If our data is <span class="math notranslate nohighlight">\(x\)</span>, at every time step, we can have a probability of firing of <span class="math notranslate nohighlight">\(T_{step}(f_{min} + \frac{v-v_{min}}{v_{max}-v_{min}}(f_{max}-f_{min}))\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(v\)</span> is the data we are representing</p></li>
<li><p><span class="math notranslate nohighlight">\(v_{max}\)</span> is the highest value we expect <span class="math notranslate nohighlight">\(x\)</span> to have</p></li>
<li><p><span class="math notranslate nohighlight">\(v_{min}\)</span> is the lowest value we expect <span class="math notranslate nohighlight">\(x\)</span> to have</p></li>
<li><p><span class="math notranslate nohighlight">\(T_{step}\)</span> is the size of our timestep</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{min}\)</span> is the minimum desired firing frequency</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{max}\)</span> is the maximum desired firing frequency</p></li>
</ul>
</li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The Neuromatch Academy has <a class="reference external" href="https://compneuro.neuromatch.io/tutorials/W0D5_Statistics/student/W0D5_Tutorial1.html#section-2-2-poisson-distribution">a helpful overview of the Poisson distribution</a></p></li>
<li><p><a class="reference external" href="https://snntorch.readthedocs.io/en/latest/tutorials/tutorial_1.html">This snnTorch tutorial</a> has a great overview of spike encoding</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="09%20-%20Collections%20of%20Neurons.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Collections of Neurons</p>
      </div>
    </a>
    <a class="right-next"
       href="11%20-%20Representing%202D%20Images.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Representing 2D Images</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-firing">Probabilistic Firing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats">Caveats:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Steve Oney
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>